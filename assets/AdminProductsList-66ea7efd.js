import{q as ie,x as m,A as O,M as ce,N as re,J as W,O as de,P as ue,Q as pe,G as ve,_ as Q,o as r,H as A,d as $,w as k,c as h,j as B,b as n,S as F,f as S,T as H,U as fe,r as K,p as he,l as _e,g as me,C as ge,F as C,h as q,s as I,e as be,t as D,i as R,n as we,V as ye}from"./index-224d8104.js";import{U as ke}from"./UseCheckLogin-949eb64f.js";import{T as L}from"./Toast-0e28cdc5.js";import{L as xe}from"./index-fa7d0c4c.js";/* empty css              */import{F as Le}from"./FormGroup-484d04b7.js";const $e=ie("modal",()=>{const e=m(!1),o=m(null);function l(){e.value=!0}function s(){e.value=!1}return O(()=>e.value,d=>{d?document.querySelector("body").classList.add("overflow-hidden"):setTimeout(()=>{document.querySelector("body").classList.remove("overflow-hidden")},300)}),{modalState:e,currentName:o,modalShow:l,modalClose:s}});function Z(e){return ce()?(re(e),!0):!1}function V(e){return typeof e=="function"?e():W(e)}const ee=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Se=Object.prototype.toString,Ce=e=>Se.call(e)==="[object Object]",P=()=>{},T=Me();function Me(){var e,o;return ee&&((e=window==null?void 0:window.navigator)==null?void 0:e.userAgent)&&(/iP(ad|hone|od)/.test(window.navigator.userAgent)||((o=window==null?void 0:window.navigator)==null?void 0:o.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}const G={mounted:"mounted",updated:"updated",unmounted:"unmounted"};function Ve(...e){if(e.length!==1)return de(...e);const o=e[0];return typeof o=="function"?ue(pe(()=>({get:o,set:P}))):m(o)}function M(e){var o;const l=V(e);return(o=l==null?void 0:l.$el)!=null?o:l}const te=ee?window:void 0;function N(...e){let o,l,s,d;if(typeof e[0]=="string"||Array.isArray(e[0])?([l,s,d]=e,o=te):[o,l,s,d]=e,!o)return P;Array.isArray(l)||(l=[l]),Array.isArray(s)||(s=[s]);const _=[],i=()=>{_.forEach(w=>w()),_.length=0},u=(w,b,a,p)=>(w.addEventListener(b,a,p),()=>w.removeEventListener(b,a,p)),v=O(()=>[M(o),V(d)],([w,b])=>{if(i(),!w)return;const a=Ce(b)?{...b}:b;_.push(...l.flatMap(p=>s.map(g=>u(w,p,g,a))))},{immediate:!0,flush:"post"}),y=()=>{v(),i()};return Z(y),y}let Y=!1;function X(e,o,l={}){const{window:s=te,ignore:d=[],capture:_=!0,detectIframe:i=!1}=l;if(!s)return;T&&!Y&&(Y=!0,Array.from(s.document.body.children).forEach(a=>a.addEventListener("click",P)),s.document.documentElement.addEventListener("click",P));let u=!0;const v=a=>d.some(p=>{if(typeof p=="string")return Array.from(s.document.querySelectorAll(p)).some(g=>g===a.target||a.composedPath().includes(g));{const g=M(p);return g&&(a.target===g||a.composedPath().includes(g))}}),w=[N(s,"click",a=>{const p=M(e);if(!(!p||p===a.target||a.composedPath().includes(p))){if(a.detail===0&&(u=!v(a)),!u){u=!0;return}o(a)}},{passive:!0,capture:_}),N(s,"pointerdown",a=>{const p=M(e);u=!v(a)&&!!(p&&!a.composedPath().includes(p))},{passive:!0}),i&&N(s,"blur",a=>{setTimeout(()=>{var p;const g=M(e);((p=s.document.activeElement)==null?void 0:p.tagName)==="IFRAME"&&!(g!=null&&g.contains(s.document.activeElement))&&o(a)},0)})].filter(Boolean);return()=>w.forEach(a=>a())}const Oe={[G.mounted](e,o){const l=!o.modifiers.bubble;if(typeof o.value=="function")e.__onClickOutside_stop=X(e,o.value,{capture:l});else{const[s,d]=o.value;e.__onClickOutside_stop=X(e,s,Object.assign({capture:l},d))}},[G.unmounted](e){e.__onClickOutside_stop()}};function z(e){return typeof Window<"u"&&e instanceof Window?e.document.documentElement:typeof Document<"u"&&e instanceof Document?e.documentElement:e}function oe(e){const o=window.getComputedStyle(e);if(o.overflowX==="scroll"||o.overflowY==="scroll"||o.overflowX==="auto"&&e.clientWidth<e.scrollWidth||o.overflowY==="auto"&&e.clientHeight<e.scrollHeight)return!0;{const l=e.parentNode;return!l||l.tagName==="BODY"?!1:oe(l)}}function De(e){const o=e||window.event,l=o.target;return oe(l)?!1:o.touches.length>1?!0:(o.preventDefault&&o.preventDefault(),!1)}const E=new WeakMap;function Ee(e,o=!1){const l=m(o);let s=null,d;O(Ve(e),u=>{const v=z(V(u));if(v){const y=v;E.get(y)||E.set(y,d),l.value&&(y.style.overflow="hidden")}},{immediate:!0});const _=()=>{const u=z(V(e));!u||l.value||(T&&(s=N(u,"touchmove",v=>{De(v)},{passive:!1})),u.style.overflow="hidden",l.value=!0)},i=()=>{var u;const v=z(V(e));!v||!l.value||(T&&(s==null||s()),v.style.overflow=(u=E.get(v))!=null?u:"",E.delete(v),l.value=!1)};return Z(i),ve({get(){return l.value},set(u){u?_():i()}})}function Ne(){let e=!1;const o=m(!1);return(l,s)=>{if(o.value=s.value,e)return;e=!0;const d=Ee(l,s.value);O(o,_=>d.value=_)}}Ne();const se=e=>(he("data-v-79757e9b"),e=e(),_e(),e),Ae={key:0,class:"modal"},Pe={class:"border rounded w-50 bg-white modalOverflow"},Ie={class:"d-flex justify-content-between border-bottom p-3"},ze={class:"border-bottom px-3"},Be=se(()=>n("button",{class:"btn btn-primary",type:"submit"},"確定",-1)),Te=se(()=>n("div",{class:"model-bg"},null,-1)),We={__name:"ModalView",props:{show:Boolean,submit:Function,modalName:String},emits:["update:show"],setup(e,{emit:o}){const l=e;function s(){o("update:show",!1)}const d=$e();O(()=>d.modalState,i=>{i?(d.currentName=l.modalName,console.log(d.currentName)):d.currentName===l.modalName&&(d.currentName=null)});function _(i){console.log(i),Object.keys(i).length===0?l.submit():l.submit(i)}return(i,u)=>{const v=K("VForm");return r(),A(fe,{to:"body"},[$(H,{name:"modal",duration:200},{default:k(()=>[l.show?(r(),h("div",Ae,[B((r(),h("div",Pe,[n("div",Ie,[F(i.$slots,"modal-head",{},void 0,!0),n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:s})]),n("div",ze,[$(v,{onSubmit:_,class:"mt-3"},{default:k(()=>[F(i.$slots,"modal-body",{},void 0,!0),n("div",{class:"p-3 text-end"},[n("button",{class:"btn btn-secondary me-2",type:"button",onClick:s}," 取消 "),Be])]),_:3})])])),[[W(Oe),s]])])):S("",!0)]),_:3}),l.show?(r(),A(H,{key:0,name:"model-bg",duration:{enter:0,leave:200}},{default:k(()=>[Te]),_:1})):S("",!0)])}}},J=Q(We,[["__scopeId","data-v-79757e9b"]]);const je={},Ue=me('<p class="placeholder-glow" data-v-1b717d54><span class="placeholder col-12" data-v-1b717d54></span></p><p class="placeholder-glow" data-v-1b717d54><span class="placeholder col-4 me-2" data-v-1b717d54></span><span class="placeholder col-7" data-v-1b717d54></span></p><p class="placeholder-glow" data-v-1b717d54><span class="placeholder col-3 me-2" data-v-1b717d54></span><span class="placeholder col-6 me-2" data-v-1b717d54></span><span class="placeholder col-2" data-v-1b717d54></span></p><p class="placeholder-glow" data-v-1b717d54><span class="placeholder col-3 me-2" data-v-1b717d54></span><span class="placeholder col-2 me-2" data-v-1b717d54></span><span class="placeholder col-2 me-2" data-v-1b717d54></span><span class="placeholder col-3" data-v-1b717d54></span></p><a href="#" tabindex="-1" class="btn btn-primary disabled placeholder col-4" aria-hidden="true" data-v-1b717d54></a>',5),Fe=[Ue];function He(e,o){return r(),h("div",null,Fe)}const qe=Q(je,[["render",He],["__scopeId","data-v-1b717d54"]]);const Re={class:"modal-outside-style"},Ge={class:"table-responsive-xl"},Ye=n("h5",{class:"mt-4"},"產品列表",-1),Xe={class:"text-end me-2"},Je={class:"table caption-top"},Qe=n("thead",null,[n("tr",null,[n("th",{style:{width:"20%"}},"分類"),n("th",{style:{width:"30%"}},"名稱"),n("th",{style:{width:"25%"}},"售價"),n("th",{style:{width:"15%"}},"狀態"),n("th",{style:{width:"10%"}})])],-1),Ke={key:0,class:"table-group-divider"},Ze={class:"badge bg-secondary"},et={key:0,class:"badge bg-success"},tt={key:1,class:"badge bg-danger"},ot=["onClick"],st=n("svg",{class:"svg-opacity",xmlns:"http://www.w3.org/2000/svg",height:"16",width:"16",viewBox:"0 0 512 512"},[n("path",{d:"M362.7 19.3L314.3 67.7 444.3 197.7l48.4-48.4c25-25 25-65.5 0-90.5L453.3 19.3c-25-25-65.5-25-90.5 0zm-71 71L58.6 323.5c-10.4 10.4-18 23.3-22.2 37.4L1 481.2C-1.5 489.7 .8 498.8 7 505s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L421.7 220.3 291.7 90.3z"})],-1),nt=[st],lt=["onClick"],at=n("svg",{class:"svg-opacity",xmlns:"http://www.w3.org/2000/svg",height:"16",width:"14",viewBox:"0 0 448 512"},[n("path",{d:"M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z"})],-1),it=[at],ct={key:0,"aria-label":"Page navigation example"},rt={class:"pagination justify-content-center mt-4"},dt={class:"page-item"},ut={class:"text-info",xmlns:"http://www.w3.org/2000/svg",height:"16",width:"16",viewBox:"0 0 512 512",style:{fill:"#0d6efd"}},pt=n("path",{d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160zm352-160l-160 160c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L301.3 256 438.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0z"},null,-1),vt=[pt],ft={class:"page-item"},ht={xmlns:"http://www.w3.org/2000/svg",height:"16",width:"10",viewBox:"0 0 320 512",style:{fill:"#0d6efd"}},_t=n("path",{d:"M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"},null,-1),mt=[_t],gt={key:0,class:"page-item"},bt=["onClick","disabled"],wt={class:"page-item"},yt={xmlns:"http://www.w3.org/2000/svg",height:"16",width:"10",viewBox:"0 0 320 512",style:{fill:"#0d6efd"}},kt=n("path",{d:"M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"},null,-1),xt=[kt],Lt={class:"page-item"},$t={xmlns:"http://www.w3.org/2000/svg",height:"16",width:"16",viewBox:"0 0 512 512",style:{fill:"#0d6efd"}},St=n("path",{d:"M470.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 256 265.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160zm-352 160l160-160c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L210.7 256 73.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0z"},null,-1),Ct=[St],Mt=n("h5",{class:"m-0"},"刪除商品",-1),Vt=n("p",{class:"m-0"},"是否要刪除商品?!",-1),Ot=n("h5",{class:"m-0"},"編輯商品",-1),zt={__name:"AdminProductsList",setup(e){const o=m(!1),{checkLogin:l}=ke(),s=m(""),d=m(!1),_=m(null);function i(f=1){l(),_.value=f,!(s.value&&(f==0||f>s.value.pagination.total_pages))&&(d.value=!0,I.get(`https://vue3-course-api.hexschool.io/v2/api/deliciousfood/admin/products?page=${f}`).then(t=>{t.data.success?s.value=t.data:L.fire({title:"無法取得產品資料，請重新整理畫面",icon:"error"})}).catch(t=>{L.fire({title:`${t.message}`,icon:"error"})}).finally(()=>{d.value=!1}))}const u=m(null),v=m(!1);function y(f){u.value=f,v.value=!0}function w(){o.value=!0,l(),I.delete(`https://vue3-course-api.hexschool.io/v2/api/deliciousfood/admin/product/${u.value}`).then(f=>{L.fire({title:`${f.data.message}`,icon:"success"}),i(_.value)}).catch(f=>{L.fire({title:`${f.message}`,icon:"error"})}).finally(()=>{o.value=!1,v.value=!1})}const b=m(!1),a=m(""),p=m(null);function g(f){a.value=f,b.value=!0;const t=ne(f)[0];p.value={title:t==null?void 0:t.title,category:t==null?void 0:t.category,unit:t==null?void 0:t.unit,price:t==null?void 0:t.price,origin_price:t==null?void 0:t.origin_price,description:t==null?void 0:t.description,content:t==null?void 0:t.content,imageUrl:t==null?void 0:t.imageUrl,is_enabled:t==null?void 0:t.is_enabled}}function ne(f){return s.value.products.filter(t=>t.id===f)}function le(f){o.value=!0;const t={data:{...f,price:Number(f.price),origin_price:Number(f.origin_price)}};I.put(`https://vue3-course-api.hexschool.io/v2/api/deliciousfood/admin/product/${a.value}`,t).then(x=>{console.log(x),L.fire({title:`${x.data.message}`,icon:"success"}),i(_.value)}).catch(x=>{console.log(x),L.fire({title:`${x.message}`,icon:"error"})}).finally(()=>{o.value=!1,b.value=!1})}const ae=[{label:"標題",name:"title",placeholder:"請輸入產品名稱",rules:"required",as:"input",type:"text"},{label:"餐飲類型",name:"category",as:"select",value:"日式",options:[{label:"日式",value:"日式"},{label:"西餐",value:"西餐"},{label:"中式",value:"中式"},{label:"甜食",value:"甜食"}]},{label:"站別",name:"unit",as:"select",value:"大慶站",options:[{label:"大慶站",value:"大慶站"},{label:"豐樂公園站",value:"豐樂公園站"},{label:"文華高中站",value:"文華高中站"},{label:"水安宮站",value:"水安宮站"},{label:"文心崇德站",value:"文心崇德站"},{label:"松竹站",value:"松竹站"}]},{label:"銷售價",name:"price",rules:"required|integer",as:"input",type:"number"},{label:"原價",name:"origin_price",rules:"required|integer",as:"input",type:"number"},{label:"商品描述",name:"description",as:"textarea"},{label:"商品內容",name:"content",as:"textarea"},{label:"商品圖片",name:"imageUrl",as:"textarea"},{label:"是否啟用",name:"is_enabled",as:"checkbox",type:"checkbox"}];return ge(()=>{i()}),(f,t)=>{const x=K("RouterLink"),j=ye("tooltip");return r(),h(C,null,[$(W(xe),{active:o.value,"onUpdate:active":t[0]||(t[0]=c=>o.value=c),loader:"dots"},null,8,["active"]),n("div",Re,[d.value?(r(),A(qe,{key:0})):(r(),h(C,{key:1},[n("div",Ge,[Ye,n("div",Xe,[$(x,{to:"/backend/addProduct",class:"btn btn-outline-danger"},{default:k(()=>[be(" 新增產品 ")]),_:1})]),n("table",Je,[Qe,s.value.products?(r(),h("tbody",Ke,[(r(!0),h(C,null,q(s.value.products,c=>(r(),h("tr",{key:c.id},[n("td",null,[n("span",Ze,D(c.unit),1)]),n("td",null,D(c.title),1),n("td",null,D(c.price),1),n("td",null,[c.is_enabled?(r(),h("span",et,"已上架")):(r(),h("span",tt,"未上架"))]),n("td",null,[B((r(),h("button",{class:"p-0 me-2 btn-icon",type:"button",onClick:R(U=>g(c.id),["stop"])},nt,8,ot)),[[j,"編輯"]]),B((r(),h("button",{class:"btn-icon p-0",type:"button",onClick:R(U=>y(c.id),["stop"])},it,8,lt)),[[j,"刪除"]])])]))),128))])):S("",!0)])]),s.value.pagination?(r(),h("nav",ct,[n("ul",rt,[n("li",dt,[n("button",{type:"button",class:"page-link",href:"#",onClick:t[1]||(t[1]=c=>i(1))},[(r(),h("svg",ut,vt))])]),n("li",ft,[n("button",{type:"button",class:"page-link",href:"#",onClick:t[2]||(t[2]=c=>i(s.value.pagination.current_page-1))},[(r(),h("svg",ht,mt))])]),(r(!0),h(C,null,q(s.value.pagination.total_pages,c=>(r(),h(C,{key:c},[c>s.value.pagination.current_page-3&&c<s.value.pagination.current_page+3?(r(),h("li",gt,[n("button",{class:we(["page-link",{disabled:c==s.value.pagination.current_page}]),onClick:U=>i(c),href:"#",disabled:c==s.value.pagination.current_page},D(c),11,bt)])):S("",!0)],64))),128)),n("li",wt,[n("button",{type:"button",class:"page-link",href:"#",onClick:t[3]||(t[3]=c=>i(s.value.pagination.current_page+1))},[(r(),h("svg",yt,xt))])]),n("li",Lt,[n("button",{type:"button",class:"page-link",href:"#",onClick:t[4]||(t[4]=c=>i(s.value.pagination.total_pages))},[(r(),h("svg",$t,Ct))])])])])):S("",!0)],64))]),$(J,{show:v.value,"onUpdate:show":t[5]||(t[5]=c=>v.value=c),submit:w},{"modal-head":k(()=>[Mt]),"modal-body":k(()=>[Vt]),_:1},8,["show"]),$(J,{show:b.value,"onUpdate:show":t[6]||(t[6]=c=>b.value=c),submit:le},{"modal-head":k(()=>[Ot]),"modal-body":k(()=>[p.value?(r(),A(Le,{key:0,"form-schema":ae,pageDate:p.value},null,8,["pageDate"])):S("",!0)]),_:1},8,["show"])],64)}}};export{zt as default};
