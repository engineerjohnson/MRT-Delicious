import{q as d,s as r}from"./index-224d8104.js";import{T as e}from"./Toast-0e28cdc5.js";const{VITE_APP_API:i,VITE_APP_PATH:o}={VITE_APP_API:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"deliciousfood",BASE_URL:"/MRT-Delicious/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},h=d("cartStore",{state:()=>({cart_data:"",cart_length:"",orderId:"",isLoading:!1,cartButton:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}),getters:{},actions:{addToCart(t,s){this.cartButton=t;const c={product_id:t,qty:s??1};r.post(`${i}/v2/api/${o}/cart`,{data:c}).then(a=>{e.fire({title:`${a.data.message}`,icon:"success"}),this.getCart(),this.cartButton=""}).catch(a=>{e.fire({title:`${a.response.data.message}`,icon:"error"})})},getCart(){this.isLoading=!0,r.get(`${i}/v2/api/${o}/cart`).then(t=>{this.cart_data=t.data.data,this.cart_length=this.cart_data.carts.length}).catch(t=>{e.fire({title:`${t.response.data.message}`,icon:"error"})}).finally(()=>{this.isLoading=!1})},updateCart(t,s){this.isLoading=!0;const c={product_id:t.product_id,qty:s??t.qty};r.put(`${i}/v2/api/${o}/cart/${t.id}`,{data:c}).then(a=>{e.fire({title:a.data.message,icon:"success"}),this.getCart()}).catch(a=>{e.fire({title:`${a.response.data.message}`,icon:"error"}),this.isLoading=!1})},deleteCart(t){r.delete(`${i}/v2/api/${o}/cart/${t.id}`).then(()=>{e.fire({title:`已將「${t.product.title}」品項刪除`,icon:"success"}),this.getCart()}).catch(()=>{e.fire({title:`無法將「${t.product.title}」品項刪除`,icon:"error"})})},deleteCartAll(){this.cart_data.carts.length!=0?r.delete(`${i}/v2/api/${o}/carts`).then(()=>{e.fire({title:"已將全部品項刪除",icon:"success"}),this.getCart()}).catch(t=>{e.fire({title:t.response.data.message,icon:"error"})}):e.fire({title:"購物車內沒東西",icon:"error"})},createOrder(){this.isLoading=!0;const t=this.form;r.post(`${i}/v2/api/${o}/order`,{data:t}).then(s=>{this.getCart(),e.fire({title:s.data.message,icon:"success"}),this.orderId=s.data.orderId,this.form.user.name="",this.form.user.email="",this.form.user.tel="",this.form.user.address="",this.form.message=""}).catch(s=>{e.fire({title:`${s.response.data.message}`,icon:"error"})}).finally(()=>{this.isLoading=!1})}}});export{h as c};
